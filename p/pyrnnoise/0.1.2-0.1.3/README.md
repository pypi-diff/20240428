# Comparing `tmp/pyrnnoise-0.1.2-py3-none-manylinux1_x86_64.whl.zip` & `tmp/pyrnnoise-0.1.3-py3-none-manylinux1_x86_64.whl.zip`

## zipinfo {}

```diff
@@ -1,12 +1,13 @@
-Zip file size: 5079590 bytes, number of entries: 10
--rw-r--r--  2.0 unx      632 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.data/purelib/pyrnnoise/__init__.py
--rw-r--r--  2.0 unx      734 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.data/purelib/pyrnnoise/cli.py
--rw-r--r--  2.0 unx  5620888 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.data/purelib/pyrnnoise/librnnoise.so
--rw-r--r--  2.0 unx     3727 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.data/purelib/pyrnnoise/pyrnnoise.py
--rw-r--r--  2.0 unx    11357 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.dist-info/LICENSE
--rw-r--r--  2.0 unx      527 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.dist-info/METADATA
--rw-r--r--  2.0 unx      107 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.dist-info/WHEEL
--rw-r--r--  2.0 unx       47 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       10 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.dist-info/top_level.txt
--rw-rw-r--  2.0 unx      921 b- defN 24-Apr-26 03:58 pyrnnoise-0.1.2.dist-info/RECORD
-10 files, 5638950 bytes uncompressed, 5077990 bytes compressed:  9.9%
+Zip file size: 5080497 bytes, number of entries: 11
+-rw-r--r--  2.0 unx      632 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.data/purelib/pyrnnoise/__init__.py
+-rw-r--r--  2.0 unx      760 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.data/purelib/pyrnnoise/cli.py
+-rw-r--r--  2.0 unx     1929 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.data/purelib/pyrnnoise/frame_queue.py
+-rw-r--r--  2.0 unx  5620888 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.data/purelib/pyrnnoise/librnnoise.so
+-rw-r--r--  2.0 unx     3383 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.data/purelib/pyrnnoise/pyrnnoise.py
+-rw-r--r--  2.0 unx    11357 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.dist-info/LICENSE
+-rw-r--r--  2.0 unx      527 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.dist-info/METADATA
+-rw-r--r--  2.0 unx      107 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.dist-info/WHEEL
+-rw-r--r--  2.0 unx       47 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       10 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1031 b- defN 24-Apr-28 10:01 pyrnnoise-0.1.3.dist-info/RECORD
+11 files, 5640671 bytes uncompressed, 5078715 bytes compressed:  10.0%
```

## zipnote {}

```diff
@@ -1,31 +1,34 @@
-Filename: pyrnnoise-0.1.2.data/purelib/pyrnnoise/__init__.py
+Filename: pyrnnoise-0.1.3.data/purelib/pyrnnoise/__init__.py
 Comment: 
 
-Filename: pyrnnoise-0.1.2.data/purelib/pyrnnoise/cli.py
+Filename: pyrnnoise-0.1.3.data/purelib/pyrnnoise/cli.py
 Comment: 
 
-Filename: pyrnnoise-0.1.2.data/purelib/pyrnnoise/librnnoise.so
+Filename: pyrnnoise-0.1.3.data/purelib/pyrnnoise/frame_queue.py
 Comment: 
 
-Filename: pyrnnoise-0.1.2.data/purelib/pyrnnoise/pyrnnoise.py
+Filename: pyrnnoise-0.1.3.data/purelib/pyrnnoise/librnnoise.so
 Comment: 
 
-Filename: pyrnnoise-0.1.2.dist-info/LICENSE
+Filename: pyrnnoise-0.1.3.data/purelib/pyrnnoise/pyrnnoise.py
 Comment: 
 
-Filename: pyrnnoise-0.1.2.dist-info/METADATA
+Filename: pyrnnoise-0.1.3.dist-info/LICENSE
 Comment: 
 
-Filename: pyrnnoise-0.1.2.dist-info/WHEEL
+Filename: pyrnnoise-0.1.3.dist-info/METADATA
 Comment: 
 
-Filename: pyrnnoise-0.1.2.dist-info/entry_points.txt
+Filename: pyrnnoise-0.1.3.dist-info/WHEEL
 Comment: 
 
-Filename: pyrnnoise-0.1.2.dist-info/top_level.txt
+Filename: pyrnnoise-0.1.3.dist-info/entry_points.txt
 Comment: 
 
-Filename: pyrnnoise-0.1.2.dist-info/RECORD
+Filename: pyrnnoise-0.1.3.dist-info/top_level.txt
+Comment: 
+
+Filename: pyrnnoise-0.1.3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## Comparing `pyrnnoise-0.1.2.data/purelib/pyrnnoise/__init__.py` & `pyrnnoise-0.1.3.data/purelib/pyrnnoise/__init__.py`

 * *Files identical despite different names*

## Comparing `pyrnnoise-0.1.2.data/purelib/pyrnnoise/cli.py` & `pyrnnoise-0.1.3.data/purelib/pyrnnoise/cli.py`

 * *Files 7% similar despite different names*

```diff
@@ -7,15 +7,15 @@
 
 
 @click.command()
 @click.argument("in_wav", type=click.Path(exists=True, file_okay=True))
 @click.argument("out_wav", type=click.Path(file_okay=True))
 @click.option("--plot/--no-plot", default=False, help="Plot the vad probabilities")
 def main(in_wav, out_wav, plot):
-    denoiser = RNNoise()
+    denoiser = RNNoise(sf.info(in_wav).samplerate)
     vad_probs = list(denoiser.process_wav(in_wav, out_wav))
 
     if plot:
         wav, sr = sf.read(in_wav)
         x1 = np.arange(0, len(wav)) / sr
         x2 = [i / 100 for i in range(0, len(vad_probs))]
         plt.plot(x1, wav)
```

## Comparing `pyrnnoise-0.1.2.data/purelib/pyrnnoise/librnnoise.so` & `pyrnnoise-0.1.3.data/purelib/pyrnnoise/librnnoise.so`

 * *Files identical despite different names*

## Comparing `pyrnnoise-0.1.2.data/purelib/pyrnnoise/pyrnnoise.py` & `pyrnnoise-0.1.3.data/purelib/pyrnnoise/pyrnnoise.py`

 * *Files 14% similar despite different names*

```diff
@@ -11,21 +11,22 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import ctypes
 import os
 import platform
-import warnings
 import wave
 
 import numpy as np
 import soxr
 from tqdm import tqdm
 
+from .frame_queue import FrameQueue
+
 
 if platform.system() == "Darwin":
     LIBRNNOISE = os.path.join(os.path.dirname(__file__), "librnnoise.dylib")
 elif platform.system() == "Windows":
     LIBRNNOISE = os.path.join(os.path.dirname(__file__), "librnnoise.dll")
 elif platform.system() == "Linux":
     LIBRNNOISE = os.path.join(os.path.dirname(__file__), "librnnoise.so")
@@ -43,55 +44,44 @@
 ]
 lib.rnnoise_create.restype = ctypes.c_void_p
 lib.rnnoise_get_frame_size.restype = ctypes.c_int
 lib.rnnoise_process_frame.restype = ctypes.c_float
 
 
 class RNNoise:
-    def __init__(self):
+    def __init__(self, sample_rate):
         self.denoise_state = lib.rnnoise_create(None)
-        self.frame_size = lib.rnnoise_get_frame_size()
+        self.frame_size_samples = lib.rnnoise_get_frame_size()
+        self.queue = FrameQueue(self.frame_size_samples, sample_rate)
 
     def __del__(self):
         lib.rnnoise_destroy(self.denoise_state)
 
-    def process_frame(self, frame):
-        if frame.shape[0] != self.frame_size:
-            warnings.warn(
-                f"The current frame size {frame.shape[0]} is less than {self.frame_size}."
-                "If it is the last frame, please pad 0."
-            )
-        data = frame.astype(np.float32)
-        in_ptr = data.ctypes.data_as(ctypes.POINTER(ctypes.c_float))
-        vad_prob = lib.rnnoise_process_frame(self.denoise_state, in_ptr, in_ptr)
-        return vad_prob, data.astype(np.int16)
+    def process_chunk(self, chunk):
+        for frame in self.queue.add_chunk(chunk):
+            data = frame.astype(np.float32)
+            in_ptr = data.ctypes.data_as(ctypes.POINTER(ctypes.c_float))
+            vad_prob = lib.rnnoise_process_frame(self.denoise_state, in_ptr, in_ptr)
+            yield vad_prob, data.astype(np.int16)
 
     def process_wav(self, in_path, out_path):
         with wave.open(in_path) as in_wav, wave.open(out_path, "w") as out_wav:
+            sr = in_wav.getframerate()
             assert in_wav.getnchannels() == 1
             assert in_wav.getsampwidth() == 2
             out_wav.setnchannels(1)
             out_wav.setsampwidth(2)
-
-            sr = in_wav.getframerate()
             out_wav.setframerate(sr)
-            if sr != 48000:
-                in_rs = soxr.ResampleStream(sr, 48000, 1, dtype=np.int16)
-                out_rs = soxr.ResampleStream(48000, sr, 1, dtype=np.int16)
-
-            frame_size = sr * self.frame_size // 48000
-            n_frames = in_wav.getnframes() // frame_size
-            progress_bar = tqdm(total=n_frames, desc="Denoising audio", unit="frames")
+
+            # chunk_size_samples = self.frame_size_samples
+            chunk_size_samples = 30 * sr // 1000
+            n_frames = in_wav.getnframes() // self.frame_size_samples
+            progress_bar = tqdm(total=n_frames, desc="Denoising audio", unit="chunks", bar_format="{l_bar}{bar}{r_bar} | {percentage:.2f}%")
             while True:
-                frame = in_wav.readframes(frame_size)
-                if not frame:
+                chunk = in_wav.readframes(chunk_size_samples)
+                if not chunk:
                     break
-                frame = np.frombuffer(frame, dtype=np.int16)
-                if sr != 48000:
-                    frame = in_rs.resample_chunk(frame)
-                frame = np.pad(frame, (0, self.frame_size - frame.shape[0]))
-                speech_prob, frame = self.process_frame(frame)
-                if sr != 48000:
-                    frame = out_rs.resample_chunk(frame)
-                out_wav.writeframes(frame)
-                progress_bar.update(1)
-                yield speech_prob
+                chunk = np.frombuffer(chunk, dtype=np.int16)
+                for speech_prob, frame in self.process_chunk(chunk):
+                    out_wav.writeframes(frame)
+                    progress_bar.update(1)
+                    yield speech_prob
```

## Comparing `pyrnnoise-0.1.2.dist-info/LICENSE` & `pyrnnoise-0.1.3.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `pyrnnoise-0.1.2.dist-info/RECORD` & `pyrnnoise-0.1.3.dist-info/RECORD`

 * *Files 21% similar despite different names*

```diff
@@ -1,10 +1,11 @@
-pyrnnoise-0.1.2.data/purelib/pyrnnoise/__init__.py,sha256=2_oq5krHb2ZeuyJF5W0c8I5YasxdY0MyHl_ZASobm2E,632
-pyrnnoise-0.1.2.data/purelib/pyrnnoise/cli.py,sha256=EZHocJLu2yNUlwZRkyjEbYODwqy0Wv6pfIrS6tPUb74,734
-pyrnnoise-0.1.2.data/purelib/pyrnnoise/librnnoise.so,sha256=Jny8lBiQgVvxruVT7SO_Mm2RNvMNk3lQOg970XjswQg,5620888
-pyrnnoise-0.1.2.data/purelib/pyrnnoise/pyrnnoise.py,sha256=MNzqJIEj4ieuvncFyGPBMT3meLTJFQV5MYcIzn5LMFw,3727
-pyrnnoise-0.1.2.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-pyrnnoise-0.1.2.dist-info/METADATA,sha256=Jl5nV3z9FCBqpZF7PGi4sI8AmzsAUO3okRYUqO96NwA,527
-pyrnnoise-0.1.2.dist-info/WHEEL,sha256=ILbpyDh5nEtfm8C49pgaj4nzkp3XS6heN4gkduq47lU,107
-pyrnnoise-0.1.2.dist-info/entry_points.txt,sha256=z8ixRvP5sl3WC0L62YeQaxHeQSqWZdqgG0Nb-BByETQ,47
-pyrnnoise-0.1.2.dist-info/top_level.txt,sha256=_2ZZpJrj3mpll2U2B991Czzkwf5GkG5BhLdPYM1lBu0,10
-pyrnnoise-0.1.2.dist-info/RECORD,,
+pyrnnoise-0.1.3.data/purelib/pyrnnoise/__init__.py,sha256=2_oq5krHb2ZeuyJF5W0c8I5YasxdY0MyHl_ZASobm2E,632
+pyrnnoise-0.1.3.data/purelib/pyrnnoise/cli.py,sha256=L1tImWor86Frd9LxLYC1EiETkRdKQbnx1EzLkRvi7uI,760
+pyrnnoise-0.1.3.data/purelib/pyrnnoise/frame_queue.py,sha256=9XJLUvLK15rW1Rx-P24t7dgG7H5kXN5VGs6DpueGJZs,1929
+pyrnnoise-0.1.3.data/purelib/pyrnnoise/librnnoise.so,sha256=Jny8lBiQgVvxruVT7SO_Mm2RNvMNk3lQOg970XjswQg,5620888
+pyrnnoise-0.1.3.data/purelib/pyrnnoise/pyrnnoise.py,sha256=PEVnR1rZDti69oNHuBdaDgiOg3lfuVFJGPay9kVDQoM,3383
+pyrnnoise-0.1.3.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+pyrnnoise-0.1.3.dist-info/METADATA,sha256=Yap8hCCFcs8_ke63MMoAeU3Fobq6XVIMulrwyE8Prl8,527
+pyrnnoise-0.1.3.dist-info/WHEEL,sha256=ILbpyDh5nEtfm8C49pgaj4nzkp3XS6heN4gkduq47lU,107
+pyrnnoise-0.1.3.dist-info/entry_points.txt,sha256=z8ixRvP5sl3WC0L62YeQaxHeQSqWZdqgG0Nb-BByETQ,47
+pyrnnoise-0.1.3.dist-info/top_level.txt,sha256=_2ZZpJrj3mpll2U2B991Czzkwf5GkG5BhLdPYM1lBu0,10
+pyrnnoise-0.1.3.dist-info/RECORD,,
```

